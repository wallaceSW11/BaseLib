{"version":3,"file":"inputs-EmailField-D2uAsb2O.js","sources":["../../../src/components/inputs/EmailField.vue"],"sourcesContent":["<template>\r\n  <v-text-field\r\n    v-model=\"internalValue\"\r\n    :label=\"label\"\r\n    :rules=\"computedRules\"\r\n    :disabled=\"disabled\"\r\n    :hint=\"hint\"\r\n    :persistent-hint=\"persistentHint\"\r\n    :required=\"required\"\r\n    :variant=\"variant\"\r\n    :maxlength=\"maxlength\"\r\n    type=\"email\"\r\n    inputmode=\"email\"\r\n    autocomplete=\"email\"\r\n    @blur=\"handleBlur\"\r\n  >\r\n    <template v-if=\"$slots.prepend\" #prepend>\r\n      <slot name=\"prepend\" />\r\n    </template>\r\n    <template v-if=\"$slots.append\" #append>\r\n      <slot name=\"append\" />\r\n    </template>\r\n    <template v-if=\"!$slots.prepend\" #prepend-inner>\r\n      <v-icon :color=\"isValid ? 'success' : undefined\">\r\n        mdi-email{{ isValid ? '-check' : '-outline' }}\r\n      </v-icon>\r\n    </template>\r\n  </v-text-field>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, watch, getCurrentInstance } from 'vue';\r\n\r\ninterface Props {\r\n  modelValue?: string;\r\n  label?: string;\r\n  rules?: any[];\r\n  disabled?: boolean;\r\n  hint?: string;\r\n  persistentHint?: boolean;\r\n  required?: boolean;\r\n  validateOnBlur?: boolean;\r\n  requiredMessage?: string;\r\n  invalidMessage?: string;\r\n  variant?: 'outlined' | 'filled' | 'plain' | 'solo' | 'solo-filled' | 'solo-inverted' | 'underlined';\r\n  maxlength?: number;\r\n}\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  modelValue: '',\r\n  label: 'Email',\r\n  rules: () => [],\r\n  disabled: false,\r\n  hint: '',\r\n  persistentHint: false,\r\n  required: false,\r\n  validateOnBlur: true,\r\n  requiredMessage: '',\r\n  invalidMessage: '',\r\n  variant: 'underlined',\r\n  maxlength: 100\r\n});\r\n\r\nconst emit = defineEmits<{\r\n  'update:modelValue': [value: string];\r\n  'valid': [isValid: boolean];\r\n}>();\r\n\r\nconst internalValue = ref(props.modelValue);\r\nconst isValid = ref(false);\r\n\r\n// Regex que aceita o padrão de email com suporte ao sinal de +\r\nconst emailRegex = /^[a-zA-Z0-9._%+\\-]+@[a-zA-Z0-9.\\-]+\\.[a-zA-Z]{2,}$/;\r\n\r\n// Tenta pegar o i18n se estiver disponível\r\nconst instance = getCurrentInstance();\r\nconst i18n = instance?.appContext.config.globalProperties.$i18n;\r\n\r\nfunction getErrorMessage(key: string, fallback: string): string {\r\n  // Se tem mensagem customizada via prop, usa ela\r\n  if (key === 'required' && props.requiredMessage) return props.requiredMessage;\r\n  if (key === 'invalid' && props.invalidMessage) return props.invalidMessage;\r\n  \r\n  // Se tem i18n disponível, tenta usar\r\n  if (i18n) {\r\n    try {\r\n      const translationKey = `validation.${key === 'required' ? 'required' : 'invalidEmail'}`;\r\n      const translated = (i18n as any).global?.t?.(translationKey) || (i18n as any).t?.(translationKey);\r\n      if (translated && typeof translated === 'string' && !translated.startsWith('validation.')) {\r\n        return translated;\r\n      }\r\n    } catch (e) {\r\n      // Ignora erro e usa fallback\r\n    }\r\n  }\r\n  \r\n  // Fallback para inglês\r\n  return fallback;\r\n}\r\n\r\nfunction validateEmail(value: string): boolean | string {\r\n  if (!value && !props.required) {\r\n    return true;\r\n  }\r\n  \r\n  if (!value && props.required) {\r\n    return getErrorMessage('required', 'Email is required');\r\n  }\r\n  \r\n  if (!emailRegex.test(value)) {\r\n    return getErrorMessage('invalid', 'Invalid email format');\r\n  }\r\n  \r\n  return true;\r\n}\r\n\r\nconst computedRules = computed(() => {\r\n  return [validateEmail, ...props.rules];\r\n});\r\n\r\nfunction handleBlur() {\r\n  const validation = validateEmail(internalValue.value);\r\n  isValid.value = validation === true;\r\n  emit('valid', isValid.value);\r\n}\r\n\r\nwatch(internalValue, (newValue) => {\r\n  emit('update:modelValue', newValue);\r\n  \r\n  // Valida em tempo real se não for validateOnBlur\r\n  if (!props.validateOnBlur) {\r\n    const validation = validateEmail(newValue);\r\n    isValid.value = validation === true;\r\n    emit('valid', isValid.value);\r\n  }\r\n});\r\n\r\nwatch(() => props.modelValue, (newValue) => {\r\n  internalValue.value = newValue || '';\r\n  const validation = validateEmail(internalValue.value);\r\n  isValid.value = validation === true;\r\n});\r\n</script>\r\n"],"names":["props","__props","emit","__emit","internalValue","ref","isValid","emailRegex","i18n","getCurrentInstance","getErrorMessage","key","fallback","translationKey","translated","validateEmail","value","computedRules","computed","handleBlur","validation","watch","newValue","_createBlock","_component_v_text_field","$event","$slots","_renderSlot","_ctx","_createVNode","_component_v_icon","_createTextVNode"],"mappings":";;;;;;;;;;;;;;;;;;;AAgDA,UAAMA,IAAQC,GAeRC,IAAOC,GAKPC,IAAgBC,EAAIL,EAAM,UAAU,GACpCM,IAAUD,EAAI,EAAK,GAGnBE,IAAa,sDAIbC,IADWC,EAAA,GACM,WAAW,OAAO,iBAAiB;AAE1D,aAASC,EAAgBC,GAAaC,GAA0B;AAE9D,UAAID,MAAQ,cAAcX,EAAM,wBAAwBA,EAAM;AAC9D,UAAIW,MAAQ,aAAaX,EAAM,uBAAuBA,EAAM;AAG5D,UAAIQ;AACF,YAAI;AACF,gBAAMK,IAAiB,cAAcF,MAAQ,aAAa,aAAa,cAAc,IAC/EG,IAAcN,EAAa,QAAQ,IAAIK,CAAc,KAAML,EAAa,IAAIK,CAAc;AAChG,cAAIC,KAAc,OAAOA,KAAe,YAAY,CAACA,EAAW,WAAW,aAAa;AACtF,mBAAOA;AAAA,QAEX,QAAY;AAAA,QAEZ;AAIF,aAAOF;AAAA,IACT;AAEA,aAASG,EAAcC,GAAiC;AACtD,aAAI,CAACA,KAAS,CAAChB,EAAM,WACZ,KAGL,CAACgB,KAAShB,EAAM,WACXU,EAAgB,YAAY,mBAAmB,IAGnDH,EAAW,KAAKS,CAAK,IAInB,KAHEN,EAAgB,WAAW,sBAAsB;AAAA,IAI5D;AAEA,UAAMO,IAAgBC,EAAS,MACtB,CAACH,GAAe,GAAGf,EAAM,KAAK,CACtC;AAED,aAASmB,IAAa;AACpB,YAAMC,IAAaL,EAAcX,EAAc,KAAK;AACpD,MAAAE,EAAQ,QAAQc,MAAe,IAC/BlB,EAAK,SAASI,EAAQ,KAAK;AAAA,IAC7B;AAEA,WAAAe,EAAMjB,GAAe,CAACkB,MAAa;AAIjC,UAHApB,EAAK,qBAAqBoB,CAAQ,GAG9B,CAACtB,EAAM,gBAAgB;AACzB,cAAMoB,IAAaL,EAAcO,CAAQ;AACzC,QAAAhB,EAAQ,QAAQc,MAAe,IAC/BlB,EAAK,SAASI,EAAQ,KAAK;AAAA,MAC7B;AAAA,IACF,CAAC,GAEDe,EAAM,MAAMrB,EAAM,YAAY,CAACsB,MAAa;AAC1C,MAAAlB,EAAc,QAAQkB,KAAY;AAClC,YAAMF,IAAaL,EAAcX,EAAc,KAAK;AACpD,MAAAE,EAAQ,QAAQc,MAAe;AAAA,IACjC,CAAC;;kBA5ICG,EA0BeC,GAAA;AAAA,oBAzBJpB,EAAA;AAAA,sDAAAA,EAAa,QAAAqB;AAAA,QACrB,OAAOxB,EAAA;AAAA,QACP,OAAOgB,EAAA;AAAA,QACP,UAAUhB,EAAA;AAAA,QACV,MAAMA,EAAA;AAAA,QACN,mBAAiBA,EAAA;AAAA,QACjB,UAAUA,EAAA;AAAA,QACV,SAASA,EAAA;AAAA,QACT,WAAWA,EAAA;AAAA,QACZ,MAAK;AAAA,QACL,WAAU;AAAA,QACV,cAAa;AAAA,QACZ,QAAMkB;AAAA,MAAA;QAESO,EAAAA,OAAO;gBAAU;AAAA,gBAC/B,MAAuB;AAAA,YAAvBC,EAAuBC,EAAA,QAAA,SAAA;AAAA,UAAA;;;QAETF,EAAAA,OAAO;gBAAS;AAAA,gBAC9B,MAAsB;AAAA,YAAtBC,EAAsBC,EAAA,QAAA,QAAA;AAAA,UAAA;;;QAEPF,EAAAA,OAAO;gBAAU;AAAA,gBAChC,MAES;AAAA,YAFTG,EAESC,GAAA;AAAA,cAFA,OAAOxB,EAAA,QAAO,YAAe;AAAA,YAAA;yBAAW,MACtC;AAAA,gBADsCyB,EAAA,iBACnCzB,EAAA,QAAO,WAAA,UAAA,GAAA,CAAA;AAAA,cAAA;;;;;;;;;;"}