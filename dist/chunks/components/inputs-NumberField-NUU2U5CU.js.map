{"version":3,"file":"inputs-NumberField-NUU2U5CU.js","sources":["../../../src/components/inputs/NumberField.vue"],"sourcesContent":["<template>\r\n  <v-text-field\r\n    :model-value=\"formattedValue\"\r\n    @update:model-value=\"handleInput\"\r\n    :label=\"label\"\r\n    :rules=\"rules\"\r\n    :disabled=\"disabled\"\r\n    :hint=\"hint\"\r\n    :persistent-hint=\"persistentHint\"\r\n    :variant=\"variant\"\r\n    @focus=\"handleFocus\"\r\n    @click=\"handleClick\"\r\n    @keydown=\"handleKeydown\"\r\n    inputmode=\"decimal\"\r\n  >\r\n    <template v-if=\"$slots.prepend\" #prepend>\r\n      <slot name=\"prepend\" />\r\n    </template>\r\n    <template v-if=\"$slots.append\" #append>\r\n      <slot name=\"append\" />\r\n    </template>\r\n  </v-text-field>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, watch, nextTick } from 'vue';\r\n\r\ninterface Props {\r\n  modelValue?: number | null;\r\n  label?: string;\r\n  rules?: any[];\r\n  disabled?: boolean;\r\n  hint?: string;\r\n  persistentHint?: boolean;\r\n  decimalPlaces?: number;\r\n  locale?: string;\r\n  allowNegative?: boolean;\r\n  variant?: 'outlined' | 'filled' | 'plain' | 'solo' | 'solo-filled' | 'solo-inverted' | 'underlined';\r\n  max?: number;\r\n  min?: number;\r\n}\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  modelValue: 0,\r\n  label: '',\r\n  rules: () => [],\r\n  disabled: false,\r\n  hint: '',\r\n  persistentHint: false,\r\n  decimalPlaces: 0,\r\n  locale: 'pt-BR',\r\n  allowNegative: true,\r\n  variant: 'underlined',\r\n  max: 999000000,\r\n  min: undefined\r\n});\r\n\r\nconst emit = defineEmits<{\r\n  'update:modelValue': [value: number];\r\n}>();\r\n\r\nconst formattedValue = ref('0');\r\n\r\nfunction formatNumber(value: number): string {\r\n  const absValue = Math.abs(value);\r\n  \r\n  const formatted = absValue.toLocaleString(props.locale, {\r\n    minimumFractionDigits: props.decimalPlaces,\r\n    maximumFractionDigits: props.decimalPlaces\r\n  });\r\n  \r\n  return value < 0 ? '-' + formatted : formatted;\r\n}\r\n\r\nfunction parseNumberInput(input: string): number {\r\n  const isNegative = input.includes('-');\r\n  const numbers = input.replace(/\\D/g, '');\r\n  \r\n  if (!numbers) return 0;\r\n  \r\n  let value: number;\r\n  \r\n  if (props.decimalPlaces === 0) {\r\n    value = parseInt(numbers);\r\n  } else {\r\n    const divisor = Math.pow(10, props.decimalPlaces);\r\n    value = parseInt(numbers) / divisor;\r\n  }\r\n  \r\n  const rounded = Number(value.toFixed(props.decimalPlaces));\r\n  \r\n  return isNegative && props.allowNegative ? -rounded : rounded;\r\n}\r\n\r\nfunction handleInput(value: string) {\r\n  const numericValue = parseNumberInput(value);\r\n  emit('update:modelValue', numericValue);\r\n  \r\n  // Força a atualização da formatação após o emit\r\n  nextTick(() => {\r\n    formattedValue.value = formatNumber(numericValue);\r\n  });\r\n}\r\n\r\nfunction handleFocus(event: FocusEvent) {\r\n  const input = event.target as HTMLInputElement | null;\r\n  nextTick(() => {\r\n    if (!input || input.value == null) return;\r\n    input.setSelectionRange(input.value.length, input.value.length);\r\n  });\r\n}\r\n\r\nfunction handleClick(event: MouseEvent) {\r\n  const input = event.target as HTMLInputElement | null;\r\n  nextTick(() => {\r\n    if (!input || input.value == null) return;\r\n    input.setSelectionRange(input.value.length, input.value.length);\r\n  });\r\n}\r\n\r\nfunction handleKeydown(event: KeyboardEvent) {\r\n  const input = event.target as HTMLInputElement | null;\r\n  if (!input) return;\r\n  const currentValue = formattedValue.value;\r\n  \r\n  // Permite teclas de navegação e controle\r\n  const allowedKeys = ['Backspace', 'Delete', 'ArrowLeft', 'ArrowRight', 'Tab', 'Home', 'End'];\r\n  \r\n  if (allowedKeys.includes(event.key) || event.ctrlKey || event.metaKey) {\r\n    if (event.key === 'Backspace' || event.key === 'Delete') {\r\n      event.preventDefault();\r\n      \r\n      // Extrai apenas os números do valor atual\r\n      const numbers = currentValue.replace(/\\D/g, '');\r\n      \r\n      if (numbers.length > 0) {\r\n        // Remove o último dígito\r\n        const newNumbers = numbers.slice(0, -1);\r\n        let newValue: number;\r\n        \r\n        if (!newNumbers) {\r\n          newValue = 0;\r\n        } else if (props.decimalPlaces === 0) {\r\n          newValue = parseInt(newNumbers);\r\n        } else {\r\n          const divisor = Math.pow(10, props.decimalPlaces);\r\n          newValue = parseInt(newNumbers) / divisor;\r\n        }\r\n        \r\n        // Mantém o sinal negativo se estava presente\r\n        const isNegative = currentValue.startsWith('-');\r\n        if (isNegative && props.allowNegative && newValue !== 0) {\r\n          newValue = -newValue;\r\n        }\r\n        \r\n        emit('update:modelValue', newValue);\r\n        formattedValue.value = formatNumber(newValue);\r\n        \r\n        // Mantém o cursor no final\r\n        nextTick(() => {\r\n          if (!input || input.value == null) return;\r\n          input.setSelectionRange(input.value.length, input.value.length);\r\n        });\r\n      }\r\n    }\r\n    return;\r\n  }\r\n  \r\n  // Permite apenas números e sinal de menos\r\n  if (!/[\\d-]/.test(event.key)) {\r\n    event.preventDefault();\r\n    return;\r\n  }\r\n  \r\n  // Previne o comportamento padrão para processar manualmente\r\n  event.preventDefault();\r\n  \r\n  if (event.key === '-' && props.allowNegative) {\r\n    // Inverte o sinal\r\n    const currentNumeric = parseNumberInput(currentValue);\r\n    const newValue = -currentNumeric;\r\n    if (props.min !== undefined && newValue < props.min) return;\r\n    if (props.max !== undefined && newValue > props.max) return;\r\n    emit('update:modelValue', newValue);\r\n    formattedValue.value = formatNumber(newValue);\r\n  } else if (event.key !== '-') {\r\n    // Adiciona o novo dígito\r\n    const numbers = currentValue.replace(/\\D/g, '');\r\n    const newNumbers = numbers + event.key;\r\n    \r\n    let newValue: number;\r\n    \r\n    if (props.decimalPlaces === 0) {\r\n      newValue = parseInt(newNumbers);\r\n    } else {\r\n      const divisor = Math.pow(10, props.decimalPlaces);\r\n      newValue = parseInt(newNumbers) / divisor;\r\n    }\r\n    \r\n    // Mantém o sinal negativo se estava presente\r\n    const isNegative = currentValue.startsWith('-');\r\n    if (isNegative && props.allowNegative) {\r\n      newValue = -newValue;\r\n    }\r\n    \r\n    if (props.max !== undefined && newValue > props.max) return;\r\n    if (props.min !== undefined && newValue < props.min) return;\r\n    emit('update:modelValue', newValue);\r\n    formattedValue.value = formatNumber(newValue);\r\n  }\r\n  \r\n  // Mantém o cursor no final\r\n  nextTick(() => {\r\n    if (!input || input.value == null) return;\r\n    input.setSelectionRange(input.value.length, input.value.length);\r\n  });\r\n}\r\n\r\nwatch(\r\n  () => props.modelValue,\r\n  (newVal) => {\r\n    const value = newVal ?? 0;\r\n    formattedValue.value = formatNumber(value);\r\n  },\r\n  { immediate: true }\r\n);\r\n</script>\r\n\r\n<style scoped>\r\n:deep(input) {\r\n  text-align: right;\r\n}\r\n\r\n/* Remove as setinhas do input number */\r\n:deep(input[type=\"number\"]::-webkit-inner-spin-button),\r\n:deep(input[type=\"number\"]::-webkit-outer-spin-button) {\r\n  -webkit-appearance: none;\r\n  margin: 0;\r\n}\r\n\r\n:deep(input[type=\"number\"]) {\r\n  -moz-appearance: textfield;\r\n  appearance: textfield;\r\n}\r\n</style>\r\n"],"names":["props","__props","emit","__emit","formattedValue","ref","formatNumber","value","formatted","parseNumberInput","input","isNegative","numbers","divisor","rounded","handleInput","numericValue","nextTick","handleFocus","event","handleClick","handleKeydown","currentValue","newNumbers","newValue","watch","newVal","_createBlock","_component_v_text_field","$slots","_renderSlot","_ctx"],"mappings":";;;;;;;;;;;;;;;;;;;;AA0CA,UAAMA,IAAQC,GAeRC,IAAOC,GAIPC,IAAiBC,EAAI,GAAG;AAE9B,aAASC,EAAaC,GAAuB;AAG3C,YAAMC,IAFW,KAAK,IAAID,CAAK,EAEJ,eAAeP,EAAM,QAAQ;AAAA,QACtD,uBAAuBA,EAAM;AAAA,QAC7B,uBAAuBA,EAAM;AAAA,MAAA,CAC9B;AAED,aAAOO,IAAQ,IAAI,MAAMC,IAAYA;AAAA,IACvC;AAEA,aAASC,EAAiBC,GAAuB;AAC/C,YAAMC,IAAaD,EAAM,SAAS,GAAG,GAC/BE,IAAUF,EAAM,QAAQ,OAAO,EAAE;AAEvC,UAAI,CAACE,EAAS,QAAO;AAErB,UAAIL;AAEJ,UAAIP,EAAM,kBAAkB;AAC1B,QAAAO,IAAQ,SAASK,CAAO;AAAA,WACnB;AACL,cAAMC,IAAU,KAAK,IAAI,IAAIb,EAAM,aAAa;AAChD,QAAAO,IAAQ,SAASK,CAAO,IAAIC;AAAA,MAC9B;AAEA,YAAMC,IAAU,OAAOP,EAAM,QAAQP,EAAM,aAAa,CAAC;AAEzD,aAAOW,KAAcX,EAAM,gBAAgB,CAACc,IAAUA;AAAA,IACxD;AAEA,aAASC,EAAYR,GAAe;AAClC,YAAMS,IAAeP,EAAiBF,CAAK;AAC3C,MAAAL,EAAK,qBAAqBc,CAAY,GAGtCC,EAAS,MAAM;AACb,QAAAb,EAAe,QAAQE,EAAaU,CAAY;AAAA,MAClD,CAAC;AAAA,IACH;AAEA,aAASE,EAAYC,GAAmB;AACtC,YAAMT,IAAQS,EAAM;AACpB,MAAAF,EAAS,MAAM;AACb,QAAI,CAACP,KAASA,EAAM,SAAS,QAC7BA,EAAM,kBAAkBA,EAAM,MAAM,QAAQA,EAAM,MAAM,MAAM;AAAA,MAChE,CAAC;AAAA,IACH;AAEA,aAASU,EAAYD,GAAmB;AACtC,YAAMT,IAAQS,EAAM;AACpB,MAAAF,EAAS,MAAM;AACb,QAAI,CAACP,KAASA,EAAM,SAAS,QAC7BA,EAAM,kBAAkBA,EAAM,MAAM,QAAQA,EAAM,MAAM,MAAM;AAAA,MAChE,CAAC;AAAA,IACH;AAEA,aAASW,EAAcF,GAAsB;AAC3C,YAAMT,IAAQS,EAAM;AACpB,UAAI,CAACT,EAAO;AACZ,YAAMY,IAAelB,EAAe;AAKpC,UAFoB,CAAC,aAAa,UAAU,aAAa,cAAc,OAAO,QAAQ,KAAK,EAE3E,SAASe,EAAM,GAAG,KAAKA,EAAM,WAAWA,EAAM,SAAS;AACrE,YAAIA,EAAM,QAAQ,eAAeA,EAAM,QAAQ,UAAU;AACvD,UAAAA,EAAM,eAAA;AAGN,gBAAMP,IAAUU,EAAa,QAAQ,OAAO,EAAE;AAE9C,cAAIV,EAAQ,SAAS,GAAG;AAEtB,kBAAMW,IAAaX,EAAQ,MAAM,GAAG,EAAE;AACtC,gBAAIY;AAEJ,gBAAI,CAACD;AACH,cAAAC,IAAW;AAAA,qBACFxB,EAAM,kBAAkB;AACjC,cAAAwB,IAAW,SAASD,CAAU;AAAA,iBACzB;AACL,oBAAMV,IAAU,KAAK,IAAI,IAAIb,EAAM,aAAa;AAChD,cAAAwB,IAAW,SAASD,CAAU,IAAIV;AAAA,YACpC;AAIA,YADmBS,EAAa,WAAW,GAAG,KAC5BtB,EAAM,iBAAiBwB,MAAa,MACpDA,IAAW,CAACA,IAGdtB,EAAK,qBAAqBsB,CAAQ,GAClCpB,EAAe,QAAQE,EAAakB,CAAQ,GAG5CP,EAAS,MAAM;AACb,cAAI,CAACP,KAASA,EAAM,SAAS,QAC7BA,EAAM,kBAAkBA,EAAM,MAAM,QAAQA,EAAM,MAAM,MAAM;AAAA,YAChE,CAAC;AAAA,UACH;AAAA,QACF;AACA;AAAA,MACF;AAGA,UAAI,CAAC,QAAQ,KAAKS,EAAM,GAAG,GAAG;AAC5B,QAAAA,EAAM,eAAA;AACN;AAAA,MACF;AAKA,UAFAA,EAAM,eAAA,GAEFA,EAAM,QAAQ,OAAOnB,EAAM,eAAe;AAG5C,cAAMwB,IAAW,CADMf,EAAiBa,CAAY;AAGpD,YADItB,EAAM,QAAQ,UAAawB,IAAWxB,EAAM,OAC5CA,EAAM,QAAQ,UAAawB,IAAWxB,EAAM,IAAK;AACrD,QAAAE,EAAK,qBAAqBsB,CAAQ,GAClCpB,EAAe,QAAQE,EAAakB,CAAQ;AAAA,MAC9C,WAAWL,EAAM,QAAQ,KAAK;AAG5B,cAAMI,IADUD,EAAa,QAAQ,OAAO,EAAE,IACjBH,EAAM;AAEnC,YAAIK;AAEJ,YAAIxB,EAAM,kBAAkB;AAC1B,UAAAwB,IAAW,SAASD,CAAU;AAAA,aACzB;AACL,gBAAMV,IAAU,KAAK,IAAI,IAAIb,EAAM,aAAa;AAChD,UAAAwB,IAAW,SAASD,CAAU,IAAIV;AAAA,QACpC;AASA,YANmBS,EAAa,WAAW,GAAG,KAC5BtB,EAAM,kBACtBwB,IAAW,CAACA,IAGVxB,EAAM,QAAQ,UAAawB,IAAWxB,EAAM,OAC5CA,EAAM,QAAQ,UAAawB,IAAWxB,EAAM,IAAK;AACrD,QAAAE,EAAK,qBAAqBsB,CAAQ,GAClCpB,EAAe,QAAQE,EAAakB,CAAQ;AAAA,MAC9C;AAGA,MAAAP,EAAS,MAAM;AACb,QAAI,CAACP,KAASA,EAAM,SAAS,QAC7BA,EAAM,kBAAkBA,EAAM,MAAM,QAAQA,EAAM,MAAM,MAAM;AAAA,MAChE,CAAC;AAAA,IACH;AAEA,WAAAe;AAAA,MACE,MAAMzB,EAAM;AAAA,MACZ,CAAC0B,MAAW;AACV,cAAMnB,IAAQmB,KAAU;AACxB,QAAAtB,EAAe,QAAQE,EAAaC,CAAK;AAAA,MAC3C;AAAA,MACA,EAAE,WAAW,GAAA;AAAA,IAAK;;kBA/NlBoB,EAoBeC,GAAA;AAAA,QAnBZ,eAAaxB,EAAA;AAAA,QACb,uBAAoBW;AAAA,QACpB,OAAOd,EAAA;AAAA,QACP,OAAOA,EAAA;AAAA,QACP,UAAUA,EAAA;AAAA,QACV,MAAMA,EAAA;AAAA,QACN,mBAAiBA,EAAA;AAAA,QACjB,SAASA,EAAA;AAAA,QACT,SAAOiB;AAAA,QACP,SAAOE;AAAA,QACP,WAASC;AAAA,QACV,WAAU;AAAA,MAAA;QAEMQ,EAAAA,OAAO;gBAAU;AAAA,gBAC/B,MAAuB;AAAA,YAAvBC,EAAuBC,EAAA,QAAA,WAAA,CAAA,GAAA,QAAA,EAAA;AAAA,UAAA;;;QAETF,EAAAA,OAAO;gBAAS;AAAA,gBAC9B,MAAsB;AAAA,YAAtBC,EAAsBC,EAAA,QAAA,UAAA,CAAA,GAAA,QAAA,EAAA;AAAA,UAAA;;;;;;;"}